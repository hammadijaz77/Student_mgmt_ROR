import t from"readable-stream";import e from"inherits";import"buffer";import i from"./BufferList.js";var r={};const f=t.Duplex;const s=e;const n=i;function BufferListStream(t){if(!(this instanceof BufferListStream))return new BufferListStream(t);if("function"===typeof t){this._callback=t;const e=function piper(t){if(this._callback){this._callback(t);this._callback=null}}.bind(this);this.on("pipe",(function onPipe(t){t.on("error",e)}));this.on("unpipe",(function onUnpipe(t){t.removeListener("error",e)}));t=null}n._init.call(this,t);f.call(this)}s(BufferListStream,f);Object.assign(BufferListStream.prototype,n.prototype);BufferListStream.prototype._new=function _new(t){return new BufferListStream(t)};BufferListStream.prototype._write=function _write(t,e,i){this._appendBuffer(t);"function"===typeof i&&i()};BufferListStream.prototype._read=function _read(t){if(!this.length)return this.push(null);t=Math.min(t,this.length);this.push(this.slice(0,t));this.consume(t)};BufferListStream.prototype.end=function end(t){f.prototype.end.call(this,t);if(this._callback){this._callback(null,this.slice());this._callback=null}};BufferListStream.prototype._destroy=function _destroy(t,e){this._bufs.length=0;this.length=0;e(t)};BufferListStream.prototype._isBufferList=function _isBufferList(t){return t instanceof BufferListStream||t instanceof n||BufferListStream.isBufferList(t)};BufferListStream.isBufferList=n.isBufferList;r=BufferListStream;r.BufferListStream=BufferListStream;r.BufferList=n;var o=r;const u=r.BufferListStream,a=r.BufferList;export default o;export{a as BufferList,u as BufferListStream};

