import t from"events";import e from"fs";import i from"path";import r from"async-each";import n from"anymatch";import s from"glob-parent";import a from"is-glob";import o from"path-is-absolute";import h from"inherits";import l from"readdirp";import d from"is-binary-path";import c from"process";import u from"fsevents";var f={};var v=c;var p=e;var _=i;var m=l;var g=d;var y=Object.create(null);function createFsWatchInstance(t,e,i,r,n){var handleEvent=function(e,r){i(t);n(e,r,{watchedPath:t});r&&t!==r&&fsWatchBroadcast(_.resolve(t,r),"listeners",_.join(t,r))};try{return p.watch(t,e,handleEvent)}catch(t){r(t)}}function fsWatchBroadcast(t,e,i,r,n){y[t]&&y[t][e].forEach((function(t){t(i,r,n)}))}function setFsWatchListener(t,e,i,r){var n=r.listener;var s=r.errHandler;var a=r.rawEmitter;var o=y[e];var h;if(!i.persistent){h=createFsWatchInstance(t,i,n,s,a);return h.close.bind(h)}if(o){o.listeners.push(n);o.errHandlers.push(s);o.rawEmitters.push(a)}else{h=createFsWatchInstance(t,i,fsWatchBroadcast.bind(null,e,"listeners"),s,fsWatchBroadcast.bind(null,e,"rawEmitters"));if(!h)return;var l=fsWatchBroadcast.bind(null,e,"errHandlers");h.on("error",(function(e){"win32"===v.platform&&"EPERM"===e.code?p.open(t,"r",(function(t,i){i&&p.close(i);t||l(e)})):l(e)}));o=y[e]={listeners:[n],errHandlers:[s],rawEmitters:[a],watcher:h}}var d=o.listeners.length-1;return function close(){delete o.listeners[d];delete o.errHandlers[d];delete o.rawEmitters[d];if(!Object.keys(o.listeners).length){o.watcher.close();delete y[e]}}}var b=Object.create(null);function setFsWatchFileListener(t,e,i,r){var n=r.listener;var s=r.rawEmitter;var a=b[e];var o=[];var h=[];if(a&&(a.options.persistent<i.persistent||a.options.interval>i.interval)){o=a.listeners;h=a.rawEmitters;p.unwatchFile(e);a=false}if(a){a.listeners.push(n);a.rawEmitters.push(s)}else{o.push(n);h.push(s);a=b[e]={listeners:o,rawEmitters:h,options:i,watcher:p.watchFile(e,i,(function(i,r){a.rawEmitters.forEach((function(t){t("change",e,{curr:i,prev:r})}));var n=i.mtime.getTime();(i.size!==r.size||n>r.mtime.getTime()||0===n)&&a.listeners.forEach((function(e){e(t,i)}))}))}}var l=a.listeners.length-1;return function close(){delete a.listeners[l];delete a.rawEmitters[l];if(!Object.keys(a.listeners).length){p.unwatchFile(e);delete b[e]}}}function NodeFsHandler(){}NodeFsHandler.prototype._watchWithNodeFs=function(t,e){var i=_.dirname(t);var r=_.basename(t);var n=this._getWatchedDir(i);n.add(r);var s=_.resolve(t);var a={persistent:this.options.persistent};e||(e=Function.prototype);var o;if(this.options.usePolling){a.interval=this.enableBinaryInterval&&g(r)?this.options.binaryInterval:this.options.interval;o=setFsWatchFileListener(t,s,a,{listener:e,rawEmitter:this.emit.bind(this,"raw")})}else o=setFsWatchListener(t,s,a,{listener:e,errHandler:this._handleError.bind(this),rawEmitter:this.emit.bind(this,"raw")});return o};NodeFsHandler.prototype._handleFile=function(t,e,i,r){var n=_.dirname(t);var s=_.basename(t);var a=this._getWatchedDir(n);if(a.has(s))return r();var o=this._watchWithNodeFs(t,function(e,i){this._throttle("watch",t,5)&&(!i||i&&0===i.mtime.getTime()?p.stat(t,function(e,i){e?this._remove(n,s):this._emit("change",t,i)}.bind(this)):a.has(s)&&this._emit("change",t,i))}.bind(this));if(!(i&&this.options.ignoreInitial)){if(!this._throttle("add",t,0))return;this._emit("add",t,e)}r&&r();return o};NodeFsHandler.prototype._handleSymlink=function(t,e,i,r){var n=t.fullPath;var s=this._getWatchedDir(e);if(!this.options.followSymlinks){this._readyCount++;p.realpath(i,function(e,a){if(s.has(r)){if(this._symlinkPaths[n]!==a){this._symlinkPaths[n]=a;this._emit("change",i,t.stat)}}else{s.add(r);this._symlinkPaths[n]=a;this._emit("add",i,t.stat)}this._emitReady()}.bind(this));return true}if(this._symlinkPaths[n])return true;this._symlinkPaths[n]=true};NodeFsHandler.prototype._handleDir=function(t,e,i,r,n,s,a){var o=this._getWatchedDir(_.dirname(t));var h=o.has(_.basename(t));i&&this.options.ignoreInitial||n||h||s.hasGlob&&!s.globFilter(t)||this._emit("addDir",t,e);o.add(_.basename(t));this._getWatchedDir(t);var l=function(e,i,a){e=_.join(e,"");if(!s.hasGlob){var o=this._throttle("readdir",e,1e3);if(!o)return}var h=this._getWatchedDir(s.path);var l=[];m({root:e,entryType:"all",fileFilter:s.filterPath,directoryFilter:s.filterDir,depth:0,lstat:true}).on("data",function(a){var o=a.path;var d=_.join(e,o);l.push(o);if((!a.stat.isSymbolicLink()||!this._handleSymlink(a,e,d,o))&&(o===n||!n&&!h.has(o))){this._readyCount++;d=_.join(t,_.relative(t,d));this._addToNodeFs(d,i,s,r+1)}}.bind(this)).on("end",function(){o&&o.clear();a&&a();h.children().filter((function(t){return t!==e&&-1===l.indexOf(t)&&(!s.hasGlob||s.filterPath({fullPath:_.resolve(e,t)}))})).forEach((function(t){this._remove(e,t)}),this)}.bind(this)).on("error",this._handleError.bind(this))}.bind(this);var d;if(null==this.options.depth||r<=this.options.depth){n||l(t,i,a);d=this._watchWithNodeFs(t,(function(t,e){e&&0===e.mtime.getTime()||l(t,false)}))}else a();return d};NodeFsHandler.prototype._addToNodeFs=function(t,e,i,r,n,s){s||(s=Function.prototype);var a=this._emitReady;if(this._isIgnored(t)||this.closed){a();return s(null,false)}var o=this._getWatchHelpers(t,r);if(!o.hasGlob&&i){o.hasGlob=i.hasGlob;o.globFilter=i.globFilter;o.filterPath=i.filterPath;o.filterDir=i.filterDir}p[o.statMethod](o.watchPath,function(i,h){if(this._handleError(i))return s(null,t);if(this._isIgnored(o.watchPath,h)){a();return s(null,false)}var l=function(t,i){return this._handleDir(t,h,e,r,i,o,a)}.bind(this);var d;if(h.isDirectory())d=l(o.watchPath,n);else if(h.isSymbolicLink()){var c=_.dirname(o.watchPath);this._getWatchedDir(c).add(o.watchPath);this._emit("add",o.watchPath,h);d=l(c,t);p.realpath(t,function(e,i){this._symlinkPaths[_.resolve(t)]=i;a()}.bind(this))}else d=this._handleFile(o.watchPath,h,e,a);d&&(this._closers[t]=d);s(null,false)}.bind(this))};f=NodeFsHandler;var w=f;var F={};var E=e;var W=i;var P=l;var k;try{k=u}catch(t){}var I=Object.create(null);var O=10;function createFSEventsInstance(t,e){return new k(t).on("fsevent",e).start()}function setFSEventsListener(t,e,i,r){var n=W.extname(t)?W.dirname(t):t;var s;var a=W.dirname(n);couldConsolidate(a)&&(n=a);var o=W.resolve(t);var h=o!==e;function filteredListener(t,r,n){h&&(t=t.replace(e,o));t!==o&&t.indexOf(o+W.sep)||i(t,r,n)}function watchedParent(){return Object.keys(I).some((function(t){if(!e.indexOf(W.resolve(t)+W.sep)){n=t;return true}}))}if(n in I||watchedParent()){s=I[n];s.listeners.push(filteredListener)}else s=I[n]={listeners:[filteredListener],rawEmitters:[r],watcher:createFSEventsInstance(n,(function(t,e){var i=k.getInfo(t,e);s.listeners.forEach((function(r){r(t,e,i)}));s.rawEmitters.forEach((function(e){e(i.event,t,i)}))}))};var l=s.listeners.length-1;return function close(){delete s.listeners[l];delete s.rawEmitters[l];if(!Object.keys(s.listeners).length){s.watcher.stop();delete I[n]}}}function couldConsolidate(t){var e=Object.keys(I);var i=0;for(var r=0,n=e.length;r<n;++r){var s=e[r];if(0===s.indexOf(t)){i++;if(i>=O)return true}}return false}function canUse(){return k&&Object.keys(I).length<128}function depth(t,e){var i=0;while(!t.indexOf(e)&&(t=W.dirname(t))!==e)i++;return i}function FsEventsHandler(){}FsEventsHandler.prototype._watchWithFsEvents=function(t,e,i,r){if(!this._isIgnored(t)){var n=function(n,s,a){if(!(void 0!==this.options.depth&&depth(n,e)>this.options.depth)){var o=i(W.join(t,W.relative(t,n)));if(!r||r(o)){var h=W.dirname(o);var l=W.basename(o);var d=this._getWatchedDir("directory"===a.type?o:h);var c=function(t){if(this._isIgnored(o,t)){this._ignoredPaths[o]=true;t&&t.isDirectory()&&(this._ignoredPaths[o+"/**/*"]=true);return true}delete this._ignoredPaths[o];delete this._ignoredPaths[o+"/**/*"]}.bind(this);var u=function(t){if(!c())if("unlink"===t)("directory"===a.type||d.has(l))&&this._remove(h,l);else{if("add"===t){"directory"===a.type&&this._getWatchedDir(o);if("symlink"===a.type&&this.options.followSymlinks){var i=void 0===this.options.depth?void 0:depth(n,e)+1;return this._addToFsEvents(o,false,true,i)}this._getWatchedDir(h).add(l)}var r="directory"===a.type?t+"Dir":t;this._emit(r,o);"addDir"===r&&this._addToFsEvents(o,false,true)}}.bind(this);var f=[69888,70400,71424,72704,73472,131328,131840,262912];if(-1!==f.indexOf(s)||"unknown"===a.event)"function"===typeof this.options.ignored?E.stat(o,(function(t,e){c(e)||(e?addOrChange():u("unlink"))})):checkFd();else switch(a.event){case"created":case"modified":return addOrChange();case"deleted":case"moved":return checkFd()}}}function addOrChange(){u(d.has(l)?"change":"add")}function checkFd(){E.open(o,"r",(function(t,e){e&&E.close(e);t&&"EACCES"!==t.code?u("unlink"):addOrChange()}))}}.bind(this);var s=setFSEventsListener(t,e,n,this.emit.bind(this,"raw"));this._emitReady();return s}};FsEventsHandler.prototype._handleFsEventsSymlink=function(t,e,i,r){if(!this._symlinkPaths[e]){this._symlinkPaths[e]=true;this._readyCount++;E.realpath(t,function(e,n){if(this._handleError(e)||this._isIgnored(n))return this._emitReady();this._readyCount++;this._addToFsEvents(n||t,(function(e){var r="."+W.sep;var s=t;n&&n!==r?s=e.replace(n,t):e!==r&&(s=W.join(t,e));return i(s)}),false,r)}.bind(this))}};FsEventsHandler.prototype._addToFsEvents=function(t,e,i,r){var n="function"===typeof e?e:function(t){return t};var s=function(t,e){var r=n(t);var s=e.isDirectory();var a=this._getWatchedDir(W.dirname(r));var o=W.basename(r);s&&this._getWatchedDir(r);if(!a.has(o)){a.add(o);this.options.ignoreInitial&&true!==i||this._emit(s?"addDir":"add",r,e)}}.bind(this);var a=this._getWatchHelpers(t);E[a.statMethod](a.watchPath,function(e,i){if(this._handleError(e)||this._isIgnored(a.watchPath,i)){this._emitReady();return this._emitReady()}if(i.isDirectory()){a.globFilter||s(n(t),i);if(r&&r>this.options.depth)return;P({root:a.watchPath,entryType:"all",fileFilter:a.filterPath,directoryFilter:a.filterDir,lstat:true,depth:this.options.depth-(r||0)}).on("data",function(t){if(!t.stat.isDirectory()||a.filterPath(t)){var e=W.join(a.watchPath,t.path);var i=t.fullPath;if(a.followSymlinks&&t.stat.isSymbolicLink()){var r=void 0===this.options.depth?void 0:depth(e,W.resolve(a.watchPath))+1;this._handleFsEventsSymlink(e,i,n,r)}else s(e,t.stat)}}.bind(this)).on("error",(function(){})).on("end",this._emitReady)}else{s(a.watchPath,i);this._emitReady()}}.bind(this));if(this.options.persistent&&true!==i){var o=function(e,i){if(!this.closed){var r=this._watchWithFsEvents(a.watchPath,W.resolve(i||a.watchPath),n,a.globFilter);r&&(this._closers[t]=r)}}.bind(this);"function"===typeof e?o():E.realpath(a.watchPath,o)}};F=FsEventsHandler;F.canUse=canUse;var S=F;var j={};var D=c;var T=t.EventEmitter;var C=e;var H=i;var N=r;var R=n;var L=s;var U=a;var x=o;var G=h;var A=w;var B=S;var arrify=function(t){return null==t?[]:Array.isArray(t)?t:[t]};var flatten=function(t,e){null==e&&(e=[]);t.forEach((function(t){Array.isArray(t)?flatten(t,e):e.push(t)}));return e};var isString=function(t){return"string"===typeof t};function FSWatcher(t){T.call(this);var e={};if(t)for(var i in t)e[i]=t[i];this._watched=Object.create(null);this._closers=Object.create(null);this._ignoredPaths=Object.create(null);Object.defineProperty(this,"_globIgnored",{get:function(){return Object.keys(this._ignoredPaths)}});this.closed=false;this._throttled=Object.create(null);this._symlinkPaths=Object.create(null);function undef(t){return void 0===e[t]}undef("persistent")&&(e.persistent=true);undef("ignoreInitial")&&(e.ignoreInitial=false);undef("ignorePermissionErrors")&&(e.ignorePermissionErrors=false);undef("interval")&&(e.interval=100);undef("binaryInterval")&&(e.binaryInterval=300);undef("disableGlobbing")&&(e.disableGlobbing=false);this.enableBinaryInterval=e.binaryInterval!==e.interval;undef("useFsEvents")&&(e.useFsEvents=!e.usePolling);B.canUse()||(e.useFsEvents=false);undef("usePolling")&&!e.useFsEvents&&(e.usePolling="darwin"===D.platform);var r=D.env.CHOKIDAR_USEPOLLING;if(void 0!==r){var n=r.toLowerCase();e.usePolling="false"!==n&&"0"!==n&&("true"===n||"1"===n||!!n)}var s=D.env.CHOKIDAR_INTERVAL;s&&(e.interval=parseInt(s));undef("atomic")&&(e.atomic=!e.usePolling&&!e.useFsEvents);e.atomic&&(this._pendingUnlinks=Object.create(null));undef("followSymlinks")&&(e.followSymlinks=true);undef("awaitWriteFinish")&&(e.awaitWriteFinish=false);true===e.awaitWriteFinish&&(e.awaitWriteFinish={});var a=e.awaitWriteFinish;if(a){a.stabilityThreshold||(a.stabilityThreshold=2e3);a.pollInterval||(a.pollInterval=100);this._pendingWrites=Object.create(null)}e.ignored&&(e.ignored=arrify(e.ignored));this._isntIgnored=function(t,e){return!this._isIgnored(t,e)}.bind(this);var o=0;this._emitReady=function(){if(++o>=this._readyCount){this._emitReady=Function.prototype;this._readyEmitted=true;D.nextTick(this.emit.bind(this,"ready"))}}.bind(this);this.options=e;Object.freeze(e)}G(FSWatcher,T);FSWatcher.prototype._emit=function(t,e,i,r,n){this.options.cwd&&(e=H.relative(this.options.cwd,e));var s=[t,e];void 0!==n?s.push(i,r,n):void 0!==r?s.push(i,r):void 0!==i&&s.push(i);var a=this.options.awaitWriteFinish;if(a&&this._pendingWrites[e]){this._pendingWrites[e].lastChange=new Date;return this}if(this.options.atomic){if("unlink"===t){this._pendingUnlinks[e]=s;setTimeout(function(){Object.keys(this._pendingUnlinks).forEach(function(t){this.emit.apply(this,this._pendingUnlinks[t]);this.emit.apply(this,["all"].concat(this._pendingUnlinks[t]));delete this._pendingUnlinks[t]}.bind(this))}.bind(this),"number"===typeof this.options.atomic?this.options.atomic:100);return this}if("add"===t&&this._pendingUnlinks[e]){t=s[0]="change";delete this._pendingUnlinks[e]}}var o=function(){this.emit.apply(this,s);"error"!==t&&this.emit.apply(this,["all"].concat(s))}.bind(this);if(a&&("add"===t||"change"===t)&&this._readyEmitted){var awfEmit=function(e,i){if(e){t=s[0]="error";s[1]=e;o()}else if(i){s.length>2?s[2]=i:s.push(i);o()}};this._awaitWriteFinish(e,a.stabilityThreshold,t,awfEmit);return this}if("change"===t&&!this._throttle("change",e,50))return this;if(!this.options.alwaysStat||void 0!==i||"add"!==t&&"addDir"!==t&&"change"!==t)o();else{var h=this.options.cwd?H.join(this.options.cwd,e):e;C.stat(h,(function(t,e){if(!t&&e){s.push(e);o()}}))}return this};FSWatcher.prototype._handleError=function(t){var e=t&&t.code;var i=this.options.ignorePermissionErrors;t&&"ENOENT"!==e&&"ENOTDIR"!==e&&(!i||"EPERM"!==e&&"EACCES"!==e)&&this.emit("error",t);return t||this.closed};FSWatcher.prototype._throttle=function(t,e,i){t in this._throttled||(this._throttled[t]=Object.create(null));var r=this._throttled[t];if(e in r)return false;function clear(){delete r[e];clearTimeout(n)}var n=setTimeout(clear,i);r[e]={timeoutObject:n,clear:clear};return r[e]};FSWatcher.prototype._awaitWriteFinish=function(t,e,i,r){var n;var s=t;this.options.cwd&&!x(t)&&(s=H.join(this.options.cwd,t));var a=new Date;var o=function(i){C.stat(s,function(s,a){if(s)"ENOENT"!==s.code&&r(s);else{var h=new Date;i&&a.size!=i.size&&(this._pendingWrites[t].lastChange=h);if(h-this._pendingWrites[t].lastChange>=e){delete this._pendingWrites[t];r(null,a)}else n=setTimeout(o.bind(this,a),this.options.awaitWriteFinish.pollInterval)}}.bind(this))}.bind(this);if(!(t in this._pendingWrites)){this._pendingWrites[t]={lastChange:a,cancelWait:function(){delete this._pendingWrites[t];clearTimeout(n);return i}.bind(this)};n=setTimeout(o.bind(this),this.options.awaitWriteFinish.pollInterval)}};var z=/\..*\.(sw[px])$|\~$|\.subl.*\.tmp/;FSWatcher.prototype._isIgnored=function(t,e){if(this.options.atomic&&z.test(t))return true;if(!this._userIgnored){var i=this.options.cwd;var r=this.options.ignored;i&&r&&(r=r.map((function(t){return"string"!==typeof t||x(t)?t:H.join(i,t)})));var n=arrify(r).filter((function(t){return"string"===typeof t&&!U(t)})).map((function(t){return t+"/**"}));this._userIgnored=R(this._globIgnored.concat(r).concat(n))}return this._userIgnored([t,e])};var M=/^\.[\/\\]/;FSWatcher.prototype._getWatchHelpers=function(t,e){t=t.replace(M,"");var i=e||this.options.disableGlobbing||!U(t)?t:L(t);var r=H.resolve(i);var n=i!==t;var s=!!n&&R(t);var a=this.options.followSymlinks;var o=!(!n||!a)&&null;var checkGlobSymlink=function(t){null==o&&(o=t.fullParentDir!==r&&{realPath:t.fullParentDir,linkPath:r});return o?t.fullPath.replace(o.realPath,o.linkPath):t.fullPath};var entryPath=function(t){return H.join(i,H.relative(i,checkGlobSymlink(t)))};var h=function(t){if(t.stat&&t.stat.isSymbolicLink())return c(t);var e=entryPath(t);return(!n||s(e))&&this._isntIgnored(e,t.stat)&&(this.options.ignorePermissionErrors||this._hasReadPermissions(t.stat))}.bind(this);var getDirParts=function(t){if(!n)return false;var e=H.relative(i,t).split(/[\/\\]/);return e};var l=getDirParts(t);l&&l.length>1&&l.pop();var d;var c=function(t){if(n){var e=getDirParts(checkGlobSymlink(t));var i=false;d=!l.every((function(t,r){"**"===t&&(i=true);return i||!e[r]||R(t,e[r])}))}return!d&&this._isntIgnored(entryPath(t),t.stat)}.bind(this);return{followSymlinks:a,statMethod:a?"stat":"lstat",path:t,watchPath:i,entryPath:entryPath,hasGlob:n,globFilter:s,filterPath:h,filterDir:c}};FSWatcher.prototype._getWatchedDir=function(t){var e=H.resolve(t);var i=this._remove.bind(this);e in this._watched||(this._watched[e]={_items:Object.create(null),add:function(t){"."!==t&&".."!==t&&(this._items[t]=true)},remove:function(t){delete this._items[t];this.children().length||C.readdir(e,(function(t){t&&i(H.dirname(e),H.basename(e))}))},has:function(t){return t in this._items},children:function(){return Object.keys(this._items)}});return this._watched[e]};FSWatcher.prototype._hasReadPermissions=function(t){return Boolean(4&parseInt((511&(t&&t.mode)).toString(8)[0],10))};FSWatcher.prototype._remove=function(t,e){var i=H.join(t,e);var r=H.resolve(i);var n=this._watched[i]||this._watched[r];if(this._throttle("remove",i,100)){var s=Object.keys(this._watched);n||this.options.useFsEvents||1!==s.length||this.add(t,e,true);var a=this._getWatchedDir(i).children();a.forEach((function(t){this._remove(i,t)}),this);var o=this._getWatchedDir(t);var h=o.has(e);o.remove(e);var l=i;this.options.cwd&&(l=H.relative(this.options.cwd,i));if(this.options.awaitWriteFinish&&this._pendingWrites[l]){var d=this._pendingWrites[l].cancelWait();if("add"===d)return}delete this._watched[i];delete this._watched[r];var c=n?"unlinkDir":"unlink";h&&!this._isIgnored(i)&&this._emit(c,i);this.options.useFsEvents||this._closePath(i)}};FSWatcher.prototype._closePath=function(t){if(this._closers[t]){this._closers[t]();delete this._closers[t];this._getWatchedDir(H.dirname(t)).remove(H.basename(t))}};FSWatcher.prototype.add=function(t,e,i){var r=this.options.cwd;this.closed=false;t=flatten(arrify(t));if(!t.every(isString))throw new TypeError("Non-string provided as watch path: "+t);r&&(t=t.map((function(t){return x(t)?t:"!"===t[0]?"!"+H.join(r,t.substring(1)):H.join(r,t)})));t=t.filter((function(t){if("!"!==t[0]){delete this._ignoredPaths[t];delete this._ignoredPaths[t+"/**"];this._userIgnored=null;return true}this._ignoredPaths[t.substring(1)]=true}),this);if(this.options.useFsEvents&&B.canUse()){this._readyCount||(this._readyCount=t.length);this.options.persistent&&(this._readyCount*=2);t.forEach(this._addToFsEvents,this)}else{this._readyCount||(this._readyCount=0);this._readyCount+=t.length;N(t,function(t,r){this._addToNodeFs(t,!i,0,0,e,function(t,e){e&&this._emitReady();r(t,e)}.bind(this))}.bind(this),function(t,i){i.forEach((function(t){t&&!this.closed&&this.add(H.dirname(t),H.basename(e||t))}),this)}.bind(this))}return this};FSWatcher.prototype.unwatch=function(t){if(this.closed)return this;t=flatten(arrify(t));t.forEach((function(t){if(!x(t)&&!this._closers[t]){this.options.cwd&&(t=H.join(this.options.cwd,t));t=H.resolve(t)}this._closePath(t);this._ignoredPaths[t]=true;t in this._watched&&(this._ignoredPaths[t+"/**"]=true);this._userIgnored=null}),this);return this};FSWatcher.prototype.close=function(){if(this.closed)return this;this.closed=true;Object.keys(this._closers).forEach((function(t){this._closers[t]();delete this._closers[t]}),this);this._watched=Object.create(null);this.removeAllListeners();return this};FSWatcher.prototype.getWatched=function(){var t={};Object.keys(this._watched).forEach(function(e){var i=this.options.cwd?H.relative(this.options.cwd,e):e;t[i||"."]=Object.keys(this._watched[e]._items).sort()}.bind(this));return t};function importHandler(t){Object.keys(t.prototype).forEach((function(e){FSWatcher.prototype[e]=t.prototype[e]}))}importHandler(A);B.canUse()&&importHandler(B);j.FSWatcher=FSWatcher;j.watch=function(t,e){return new FSWatcher(e).add(t)};const K=j.watch;const $=j.FSWatcher;export default j;export{$ as FSWatcher,K as watch};

