import t from"buffer";var e="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var i={};var s=t.Buffer;var r={};var h=r.LEFT_BRACE=1;var a=r.RIGHT_BRACE=2;var n=r.LEFT_BRACKET=3;var f=r.RIGHT_BRACKET=4;var o=r.COLON=5;var u=r.COMMA=6;var S=r.TRUE=7;var g=r.FALSE=8;var l=r.NULL=9;var v=r.STRING=10;var c=r.NUMBER=11;var p=r.START=17;var d=r.STOP=18;var E=r.TRUE1=33;var m=r.TRUE2=34;var y=r.TRUE3=35;var _=r.FALSE1=49;var C=r.FALSE2=50;var T=r.FALSE3=51;var k=r.FALSE4=52;var b=r.NULL1=65;var B=r.NULL2=66;var R=r.NULL3=67;var A=r.NUMBER1=81;var N=r.NUMBER3=83;var O=r.STRING1=97;var L=r.STRING2=98;var U=r.STRING3=99;var w=r.STRING4=100;var q=r.STRING5=101;var I=r.STRING6=102;var P=r.VALUE=113;var G=r.KEY=114;var F=r.OBJECT=129;var M=r.ARRAY=130;var x="\\".charCodeAt(0);var J="/".charCodeAt(0);var K="\b".charCodeAt(0);var V="\f".charCodeAt(0);var H="\n".charCodeAt(0);var Y="\r".charCodeAt(0);var j="\t".charCodeAt(0);var z=64*1024;function Parser(){(this||e).tState=p;(this||e).value=void 0;(this||e).string=void 0;(this||e).stringBuffer=s.alloc?s.alloc(z):new s(z);(this||e).stringBufferOffset=0;(this||e).unicode=void 0;(this||e).highSurrogate=void 0;(this||e).key=void 0;(this||e).mode=void 0;(this||e).stack=[];(this||e).state=P;(this||e).bytes_remaining=0;(this||e).bytes_in_sequence=0;(this||e).temp_buffs={2:new s(2),3:new s(3),4:new s(4)};(this||e).offset=-1}Parser.toknam=function(t){var e=Object.keys(r);for(var i=0,s=e.length;i<s;i++){var h=e[i];if(r[h]===t)return h}return t&&"0x"+t.toString(16)};var D=Parser.prototype;D.onError=function(t){throw t};D.charError=function(t,i){(this||e).tState=d;this.onError(new Error("Unexpected "+JSON.stringify(String.fromCharCode(t[i]))+" at position "+i+" in state "+Parser.toknam((this||e).tState)))};D.appendStringChar=function(t){if((this||e).stringBufferOffset>=z){(this||e).string+=(this||e).stringBuffer.toString("utf8");(this||e).stringBufferOffset=0}(this||e).stringBuffer[(this||e).stringBufferOffset++]=t};D.appendStringBuf=function(t,i,s){var r=t.length;"number"===typeof i&&(r="number"===typeof s?s<0?t.length-i+s:s-i:t.length-i);r<0&&(r=0);if((this||e).stringBufferOffset+r>z){(this||e).string+=(this||e).stringBuffer.toString("utf8",0,(this||e).stringBufferOffset);(this||e).stringBufferOffset=0}t.copy((this||e).stringBuffer,(this||e).stringBufferOffset,i,s);(this||e).stringBufferOffset+=r};D.write=function(t){"string"===typeof t&&(t=new s(t));var i;for(var r=0,d=t.length;r<d;r++)if((this||e).tState===p){i=t[r];(this||e).offset++;if(123===i)this.onToken(h,"{");else if(125===i)this.onToken(a,"}");else if(91===i)this.onToken(n,"[");else if(93===i)this.onToken(f,"]");else if(58===i)this.onToken(o,":");else if(44===i)this.onToken(u,",");else if(116===i)(this||e).tState=E;else if(102===i)(this||e).tState=_;else if(110===i)(this||e).tState=b;else if(34===i){(this||e).string="";(this||e).stringBufferOffset=0;(this||e).tState=O}else if(45===i){(this||e).string="-";(this||e).tState=A}else if(i>=48&&i<64){(this||e).string=String.fromCharCode(i);(this||e).tState=N}else if(32!==i&&9!==i&&10!==i&&13!==i)return this.charError(t,r)}else if((this||e).tState===O){i=t[r];if((this||e).bytes_remaining>0){for(var P=0;P<(this||e).bytes_remaining;P++)(this||e).temp_buffs[(this||e).bytes_in_sequence][(this||e).bytes_in_sequence-(this||e).bytes_remaining+P]=t[P];this.appendStringBuf((this||e).temp_buffs[(this||e).bytes_in_sequence]);(this||e).bytes_in_sequence=(this||e).bytes_remaining=0;r=r+P-1}else if(0===(this||e).bytes_remaining&&i>=128){if(i<=193||i>244)return this.onError(new Error("Invalid UTF-8 character at position "+r+" in state "+Parser.toknam((this||e).tState)));i>=194&&i<=223&&((this||e).bytes_in_sequence=2);i>=224&&i<=239&&((this||e).bytes_in_sequence=3);i>=240&&i<=244&&((this||e).bytes_in_sequence=4);if((this||e).bytes_in_sequence+r>t.length){for(var G=0;G<=t.length-1-r;G++)(this||e).temp_buffs[(this||e).bytes_in_sequence][G]=t[r+G];(this||e).bytes_remaining=r+(this||e).bytes_in_sequence-t.length;r=t.length-1}else{this.appendStringBuf(t,r,r+(this||e).bytes_in_sequence);r=r+(this||e).bytes_in_sequence-1}}else if(34===i){(this||e).tState=p;(this||e).string+=(this||e).stringBuffer.toString("utf8",0,(this||e).stringBufferOffset);(this||e).stringBufferOffset=0;this.onToken(v,(this||e).string);(this||e).offset+=s.byteLength((this||e).string,"utf8")+1;(this||e).string=void 0}else if(92===i)(this||e).tState=L;else{if(!(i>=32))return this.charError(t,r);this.appendStringChar(i)}}else if((this||e).tState===L){i=t[r];if(34===i){this.appendStringChar(i);(this||e).tState=O}else if(92===i){this.appendStringChar(x);(this||e).tState=O}else if(47===i){this.appendStringChar(J);(this||e).tState=O}else if(98===i){this.appendStringChar(K);(this||e).tState=O}else if(102===i){this.appendStringChar(V);(this||e).tState=O}else if(110===i){this.appendStringChar(H);(this||e).tState=O}else if(114===i){this.appendStringChar(Y);(this||e).tState=O}else if(116===i){this.appendStringChar(j);(this||e).tState=O}else{if(117!==i)return this.charError(t,r);(this||e).unicode="";(this||e).tState=U}}else if((this||e).tState===U||(this||e).tState===w||(this||e).tState===q||(this||e).tState===I){i=t[r];if(!(i>=48&&i<64||i>64&&i<=70||i>96&&i<=102))return this.charError(t,r);(this||e).unicode+=String.fromCharCode(i);if((this||e).tState++===I){var F=parseInt((this||e).unicode,16);(this||e).unicode=void 0;if(void 0!==(this||e).highSurrogate&&F>=56320&&F<57343+1){this.appendStringBuf(new s(String.fromCharCode((this||e).highSurrogate,F)));(this||e).highSurrogate=void 0}else if(void 0===(this||e).highSurrogate&&F>=55296&&F<56319+1)(this||e).highSurrogate=F;else{if(void 0!==(this||e).highSurrogate){this.appendStringBuf(new s(String.fromCharCode((this||e).highSurrogate)));(this||e).highSurrogate=void 0}this.appendStringBuf(new s(String.fromCharCode(F)))}(this||e).tState=O}}else if((this||e).tState===A||(this||e).tState===N){i=t[r];switch(i){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 46:case 101:case 69:case 43:case 45:(this||e).string+=String.fromCharCode(i);(this||e).tState=N;break;default:(this||e).tState=p;var M=Number((this||e).string);if(isNaN(M))return this.charError(t,r);(this||e).string.match(/[0-9]+/)==(this||e).string&&M.toString()!=(this||e).string?this.onToken(v,(this||e).string):this.onToken(c,M);(this||e).offset+=(this||e).string.length-1;(this||e).string=void 0;r--;break}}else if((this||e).tState===E){if(114!==t[r])return this.charError(t,r);(this||e).tState=m}else if((this||e).tState===m){if(117!==t[r])return this.charError(t,r);(this||e).tState=y}else if((this||e).tState===y){if(101!==t[r])return this.charError(t,r);(this||e).tState=p;this.onToken(S,true);(this||e).offset+=3}else if((this||e).tState===_){if(97!==t[r])return this.charError(t,r);(this||e).tState=C}else if((this||e).tState===C){if(108!==t[r])return this.charError(t,r);(this||e).tState=T}else if((this||e).tState===T){if(115!==t[r])return this.charError(t,r);(this||e).tState=k}else if((this||e).tState===k){if(101!==t[r])return this.charError(t,r);(this||e).tState=p;this.onToken(g,false);(this||e).offset+=4}else if((this||e).tState===b){if(117!==t[r])return this.charError(t,r);(this||e).tState=B}else if((this||e).tState===B){if(108!==t[r])return this.charError(t,r);(this||e).tState=R}else if((this||e).tState===R){if(108!==t[r])return this.charError(t,r);(this||e).tState=p;this.onToken(l,null);(this||e).offset+=3}};D.onToken=function(t,e){};D.parseError=function(t,i){(this||e).tState=d;this.onError(new Error("Unexpected "+Parser.toknam(t)+(i?"("+JSON.stringify(i)+")":"")+" in state "+Parser.toknam((this||e).state)))};D.push=function(){(this||e).stack.push({value:(this||e).value,key:(this||e).key,mode:(this||e).mode})};D.pop=function(){var t=(this||e).value;var i=(this||e).stack.pop();(this||e).value=i.value;(this||e).key=i.key;(this||e).mode=i.mode;this.emit(t);(this||e).mode||((this||e).state=P)};D.emit=function(t){(this||e).mode&&((this||e).state=u);this.onValue(t)};D.onValue=function(t){};D.onToken=function(t,i){if((this||e).state===P)if(t===v||t===c||t===S||t===g||t===l){(this||e).value&&((this||e).value[(this||e).key]=i);this.emit(i)}else if(t===h){this.push();(this||e).value?(this||e).value=(this||e).value[(this||e).key]={}:(this||e).value={};(this||e).key=void 0;(this||e).state=G;(this||e).mode=F}else if(t===n){this.push();(this||e).value?(this||e).value=(this||e).value[(this||e).key]=[]:(this||e).value=[];(this||e).key=0;(this||e).mode=M;(this||e).state=P}else if(t===a){if((this||e).mode!==F)return this.parseError(t,i);this.pop()}else{if(t!==f)return this.parseError(t,i);if((this||e).mode!==M)return this.parseError(t,i);this.pop()}else if((this||e).state===G)if(t===v){(this||e).key=i;(this||e).state=o}else{if(t!==a)return this.parseError(t,i);this.pop()}else if((this||e).state===o){if(t!==o)return this.parseError(t,i);(this||e).state=P}else{if((this||e).state!==u)return this.parseError(t,i);if(t===u)if((this||e).mode===M){(this||e).key++;(this||e).state=P}else(this||e).mode===F&&((this||e).state=G);else{if(!(t===f&&(this||e).mode===M||t===a&&(this||e).mode===F))return this.parseError(t,i);this.pop()}}};Parser.C=r;i=Parser;var Q=i;export default Q;

