import e from"undeclared-identifiers";import r from"through2";import t from"xtend";import n from"acorn-node";import i from"path";import a from"path-is-absolute";import o from"combine-source-map";import u from"buffer";var f="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var s={};function _nullRequire(e){var r=new Error("Cannot find module '"+e+"'");r.code="MODULE_NOT_FOUND";throw r}_nullRequire.resolve=_nullRequire;var l=u.Buffer;var c=e;var v=r;var m=t;var p=n.parse;var d=i;var g=d.isAbsolute||a;var h="process/browser.js";var b="is-buffer";var y=o;function getRelativeRequirePath(e,r){var t=d.relative(d.dirname(r),e);/^\./.test(t)||g(t)||(t="./"+t);"\\"===d.sep&&(t=t.replace(/\\/g,"/"));return t}var _={process:function(e){var r=getRelativeRequirePath(h,e);return"require("+JSON.stringify(r)+")"},global:function(){return'typeof global !== "undefined" ? global : '+'typeof self !== "undefined" ? self : '+'typeof window !== "undefined" ? window : {}'},"Buffer.isBuffer":function(e){var r=getRelativeRequirePath(b,e);return"require("+JSON.stringify(r)+")"},Buffer:function(){return'require("buffer").Buffer'},setImmediate:function(){return'require("timers").setImmediate'},clearImmediate:function(){return'require("timers").clearImmediate'},__filename:function(e,r){var t=d.relative(r,e);"\\"===d.sep&&(t=t.replace(/\\/g,"/"));var n="/"+t;return JSON.stringify(n)},__dirname:function(e,r){var t=d.relative(r,e);"\\"===d.sep&&(t=t.replace(/\\/g,"/"));var n=d.dirname("/"+t);return JSON.stringify(n)}};s=function(e,r){if(/\.json$/i.test(e))return v();r||(r={});var t=r.basedir||"/";var n=m(_,r.vars);var i=Object.keys(n).filter((function(e){return"function"===typeof n[e]}));var a=RegExp(i.map((function(e){return"\\b"+e+"\\b"})).join("|"));var o=[];return v(write,end);function write(e,r,t){o.push(e);t()}function end(){var u=this||f;var s=l.isBuffer(o[0])?l.concat(o).toString("utf8"):o.join("");s=s.replace(/^\ufeff/,"").replace(/^#![^\n]*\n/,"\n");if(true===r.always||a.test(s)){try{var v=r.always?{identifiers:i,properties:[]}:c(p(s),{wildcard:true})}catch(r){var m=new SyntaxError((r.message||r)+" while parsing "+e);m.type="syntax";m.filename=e;return this.emit("error",m)}var d={};i.forEach((function(r){if(/\./.test(r)){var i=r.split(".");var a=v.properties.indexOf(r);if(!(-1===a||countprops(v.properties,i[0])>1)){var o=n[r](e,t);if(o){d[i[0]]="{"+JSON.stringify(i[1])+":"+o+"}";u.emit("global",r)}}}}));i.forEach((function(r){if(!/\./.test(r)&&!d[r]&&!(v.identifiers.indexOf(r)<0)){var i=n[r](e,t);if(i){d[r]=i;u.emit("global",r)}}}));this.push(closeOver(d,s,e,r));this.push(null)}else{this.push(s);this.push(null)}}};s.vars=_;function closeOver(e,r,t,n){var i=Object.keys(e);if(0===i.length)return r;var a=i.map((function(r){return e[r]}));var o="(function (){\n"+r+"\n}).call(this)";if(i.length<=3)o="(function ("+i.join(",")+"){"+o+"}).call(this,"+a.join(",")+")";else{var u=["__argument0","__argument1","__argument2","__argument3"];var f=i.slice(0,3).concat(u).concat(i.slice(3));a.splice(3,0,"arguments[3]","arguments[4]","arguments[5]","arguments[6]");o="(function ("+f.join(",")+"){"+o+"}).call(this,"+a.join(",")+")"}if(!n.debug)return o;var s=d.relative(n.basedir,t).replace(/\\/g,"/");var l=y.create().addFile({sourceFile:s,source:r},{line:1});return y.removeComments(o)+"\n"+l.comment()}function countprops(e,r){return e.filter((function(e){return e.slice(0,r.length+1)===r+"."})).length}var w=s;const O=s.vars;export default w;export{O as vars};

