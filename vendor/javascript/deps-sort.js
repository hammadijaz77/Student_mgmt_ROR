import e from"through2";import r from"shasum-object";var n="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var t={};var d=e;var i=r;t=function(e){e||(e={});var r=[];return d.obj(write,end);function write(e,n,t){r.push(e);t()}function end(){var t=this||n;r.sort(cmp);sorter(r,t,e)}};function sorter(e,r,n){var t=n.expose||{};Array.isArray(t)&&(t=t.reduce((function(e,r){e[r]=true;return e}),{}));var d={},a={};var u=depCmp();if(n.dedupe){e.forEach((function(e){var r=i(e.source);u.add(e,r);d[r]?d[r].push(e):d[r]=[e]}));Object.keys(d).forEach((function(e){var r=d[e];while(r.length>1){var n=r.pop();n.dedupe=r[0].id;n.sameDeps=u.cmp(r[0].deps,n.deps);a[n.id]=r[0].id}}))}if(n.index){var o={};var f=0;e.forEach((function(e,r){if(has(t,e.id)){e.index=e.id;f++;true!==t[e.id]&&(o[t[e.id]]=e.index)}else e.index=r+1-f;o[e.id]=e.index}));e.forEach((function(e){e.indexDeps={};Object.keys(e.deps).forEach((function(r){var n=e.deps[r];e.indexDeps[r]=o[n]}));e.dedupe&&(e.dedupeIndex=o[e.dedupe]);r.push(e)}))}else e.forEach((function(e){r.push(e)}));r.push(null)}function cmp(e,r){return e.id+e.hash<r.id+r.hash?-1:1}function has(e,r){return Object.prototype.hasOwnProperty.call(e,r)}function depCmp(){var e={},r={};return{add:add,cmp:cmp};function add(n,t){e[n.id]=n.deps;r[n.id]=t}function cmp(n,t,d){if(!n&&!t)return true;if(!n||!t)return false;var i=Object.keys(n);if(i.length!==Object.keys(t).length)return false;for(var a=0;a<i.length;a++){var u=i[a],o=n[u],f=t[u];var s=r[o];var p=r[f];var c=e[o];var h=e[f];if(o!==f&&(s!==p||!d&&!cmp(c,h,1)))return false}return true}}var a=t;export default a;

