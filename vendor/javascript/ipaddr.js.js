var r="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var t={};var e={exports:t};(function(){var t,n,i,o,a,s,p,u,v;n={};u=this||r;null!==e&&e.exports?e.exports=n:u["ipaddr"]=n;p=function(r,t,e,n){var i,o;if(r.length!==t.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");i=0;while(n>0){o=e-n;o<0&&(o=0);if(r[i]>>o!==t[i]>>o)return false;n-=e;i+=1}return true};n.subnetMatch=function(r,t,e){var n,i,o,a,s;null==e&&(e="unicast");for(o in t){a=t[o];!a[0]||a[0]instanceof Array||(a=[a]);for(n=0,i=a.length;n<i;n++){s=a[n];if(r.kind()===s[0].kind()&&r.match.apply(r,s))return o}}return e};n.IPv4=function(){function IPv4(t){var e,n,i;if(4!==t.length)throw new Error("ipaddr: ipv4 octet count should be 4");for(e=0,n=t.length;e<n;e++){i=t[e];if(!(0<=i&&i<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits")}(this||r).octets=t}IPv4.prototype.kind=function(){return"ipv4"};IPv4.prototype.toString=function(){return(this||r).octets.join(".")};IPv4.prototype.toNormalizedString=function(){return this.toString()};IPv4.prototype.toByteArray=function(){return(this||r).octets.slice(0)};IPv4.prototype.match=function(t,e){var n;void 0===e&&(n=t,t=n[0],e=n[1]);if("ipv4"!==t.kind())throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return p((this||r).octets,t.octets,8,e)};IPv4.prototype.SpecialRanges={unspecified:[[new IPv4([0,0,0,0]),8]],broadcast:[[new IPv4([255,255,255,255]),32]],multicast:[[new IPv4([224,0,0,0]),4]],linkLocal:[[new IPv4([169,254,0,0]),16]],loopback:[[new IPv4([127,0,0,0]),8]],carrierGradeNat:[[new IPv4([100,64,0,0]),10]],private:[[new IPv4([10,0,0,0]),8],[new IPv4([172,16,0,0]),12],[new IPv4([192,168,0,0]),16]],reserved:[[new IPv4([192,0,0,0]),24],[new IPv4([192,0,2,0]),24],[new IPv4([192,88,99,0]),24],[new IPv4([198,51,100,0]),24],[new IPv4([203,0,113,0]),24],[new IPv4([240,0,0,0]),4]]};IPv4.prototype.range=function(){return n.subnetMatch(this||r,(this||r).SpecialRanges)};IPv4.prototype.toIPv4MappedAddress=function(){return n.IPv6.parse("::ffff:"+this.toString())};IPv4.prototype.prefixLengthFromSubnetMask=function(){var t,e,n,i,o,a,s;s={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};t=0;o=false;for(e=n=3;n>=0;e=n+=-1){i=(this||r).octets[e];if(!(i in s))return null;a=s[i];if(o&&0!==a)return null;8!==a&&(o=true);t+=a}return 32-t};return IPv4}();i="(0?\\d+|0x[a-f0-9]+)";o={fourOctet:new RegExp("^"+i+"\\."+i+"\\."+i+"\\."+i+"$","i"),longValue:new RegExp("^"+i+"$","i")};n.IPv4.parser=function(r){var t,e,n,i,a;e=function(r){return"0"===r[0]&&"x"!==r[1]?parseInt(r,8):parseInt(r)};if(t=r.match(o.fourOctet))return function(){var r,i,o,a;o=t.slice(1,6);a=[];for(r=0,i=o.length;r<i;r++){n=o[r];a.push(e(n))}return a}();if(t=r.match(o.longValue)){a=e(t[1]);if(a>4294967295||a<0)throw new Error("ipaddr: address outside defined range");return function(){var r,t;t=[];for(i=r=0;r<=24;i=r+=8)t.push(a>>i&255);return t}().reverse()}return null};n.IPv6=function(){function IPv6(t,e){var n,i,o,a,s,p;if(16===t.length){(this||r).parts=[];for(n=i=0;i<=14;n=i+=2)(this||r).parts.push(t[n]<<8|t[n+1])}else{if(8!==t.length)throw new Error("ipaddr: ipv6 part count should be 8 or 16");(this||r).parts=t}p=(this||r).parts;for(o=0,a=p.length;o<a;o++){s=p[o];if(!(0<=s&&s<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits")}e&&((this||r).zoneId=e)}IPv6.prototype.kind=function(){return"ipv6"};IPv6.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")};IPv6.prototype.toRFC5952String=function(){var r,t,e,n,i;n=/((^|:)(0(:|$)){2,})/g;i=this.toNormalizedString();r=0;t=-1;while(e=n.exec(i))if(e[0].length>t){r=e.index;t=e[0].length}return t<0?i:i.substring(0,r)+"::"+i.substring(r+t)};IPv6.prototype.toByteArray=function(){var t,e,n,i,o;t=[];o=(this||r).parts;for(e=0,n=o.length;e<n;e++){i=o[e];t.push(i>>8);t.push(255&i)}return t};IPv6.prototype.toNormalizedString=function(){var t,e,n;t=function(){var t,n,i,o;i=(this||r).parts;o=[];for(t=0,n=i.length;t<n;t++){e=i[t];o.push(e.toString(16))}return o}.call(this||r).join(":");n="";(this||r).zoneId&&(n="%"+(this||r).zoneId);return t+n};IPv6.prototype.toFixedLengthString=function(){var t,e,n;t=function(){var t,n,i,o;i=(this||r).parts;o=[];for(t=0,n=i.length;t<n;t++){e=i[t];o.push(e.toString(16).padStart(4,"0"))}return o}.call(this||r).join(":");n="";(this||r).zoneId&&(n="%"+(this||r).zoneId);return t+n};IPv6.prototype.match=function(t,e){var n;void 0===e&&(n=t,t=n[0],e=n[1]);if("ipv6"!==t.kind())throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return p((this||r).parts,t.parts,16,e)};IPv6.prototype.SpecialRanges={unspecified:[new IPv6([0,0,0,0,0,0,0,0]),128],linkLocal:[new IPv6([65152,0,0,0,0,0,0,0]),10],multicast:[new IPv6([65280,0,0,0,0,0,0,0]),8],loopback:[new IPv6([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new IPv6([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new IPv6([0,0,0,0,0,65535,0,0]),96],rfc6145:[new IPv6([0,0,0,0,65535,0,0,0]),96],rfc6052:[new IPv6([100,65435,0,0,0,0,0,0]),96],"6to4":[new IPv6([8194,0,0,0,0,0,0,0]),16],teredo:[new IPv6([8193,0,0,0,0,0,0,0]),32],reserved:[[new IPv6([8193,3512,0,0,0,0,0,0]),32]]};IPv6.prototype.range=function(){return n.subnetMatch(this||r,(this||r).SpecialRanges)};IPv6.prototype.isIPv4MappedAddress=function(){return"ipv4Mapped"===this.range()};IPv6.prototype.toIPv4Address=function(){var t,e,i;if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");i=(this||r).parts.slice(-2),t=i[0],e=i[1];return new n.IPv4([t>>8,255&t,e>>8,255&e])};IPv6.prototype.prefixLengthFromSubnetMask=function(){var t,e,n,i,o,a,s;s={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0};t=0;o=false;for(e=n=7;n>=0;e=n+=-1){i=(this||r).parts[e];if(!(i in s))return null;a=s[i];if(o&&0!==a)return null;16!==a&&(o=true);t+=a}return 128-t};return IPv6}();a="(?:[0-9a-f]+::?)+";v="%[0-9a-z]{1,}";s={zoneIndex:new RegExp(v,"i"),native:new RegExp("^(::)?("+a+")?([0-9a-f]+)?(::)?("+v+")?$","i"),transitional:new RegExp("^((?:"+a+")|(?:::)(?:"+a+")?)"+i+"\\."+i+"\\."+i+"\\."+i+"("+v+")?$","i")};t=function(r,t){var e,n,i,o,a,p;if(r.indexOf("::")!==r.lastIndexOf("::"))return null;p=(r.match(s["zoneIndex"])||[])[0];if(p){p=p.substring(1);r=r.replace(/%.+$/,"")}e=0;n=-1;while((n=r.indexOf(":",n+1))>=0)e++;"::"===r.substr(0,2)&&e--;"::"===r.substr(-2,2)&&e--;if(e>t)return null;a=t-e;o=":";while(a--)o+="0:";r=r.replace("::",o);":"===r[0]&&(r=r.slice(1));":"===r[r.length-1]&&(r=r.slice(0,-1));t=function(){var t,e,n,o;n=r.split(":");o=[];for(t=0,e=n.length;t<e;t++){i=n[t];o.push(parseInt(i,16))}return o}();return{parts:t,zoneId:p}};n.IPv6.parser=function(r){var e,n,i,o,a,p,u;if(s["native"].test(r))return t(r,8);if(o=r.match(s["transitional"])){u=o[6]||"";e=t(o[1].slice(0,-1)+u,6);if(e.parts){p=[parseInt(o[2]),parseInt(o[3]),parseInt(o[4]),parseInt(o[5])];for(n=0,i=p.length;n<i;n++){a=p[n];if(!(0<=a&&a<=255))return null}e.parts.push(p[0]<<8|p[1]);e.parts.push(p[2]<<8|p[3]);return{parts:e.parts,zoneId:e.zoneId}}}return null};n.IPv4.isIPv4=n.IPv6.isIPv6=function(r){return null!==this.parser(r)};n.IPv4.isValid=function(t){var e;try{new(this||r)(this.parser(t));return true}catch(r){e=r;return false}};n.IPv4.isValidFourPartDecimal=function(r){return!(!n.IPv4.isValid(r)||!r.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))};n.IPv6.isValid=function(t){var e,n;if("string"===typeof t&&-1===t.indexOf(":"))return false;try{e=this.parser(t);new(this||r)(e.parts,e.zoneId);return true}catch(r){n=r;return false}};n.IPv4.parse=function(t){var e;e=this.parser(t);if(null===e)throw new Error("ipaddr: string is not formatted like ip address");return new(this||r)(e)};n.IPv6.parse=function(t){var e;e=this.parser(t);if(null===e.parts)throw new Error("ipaddr: string is not formatted like ip address");return new(this||r)(e.parts,e.zoneId)};n.IPv4.parseCIDR=function(r){var t,e,n;if(e=r.match(/^(.+)\/(\d+)$/)){t=parseInt(e[2]);if(t>=0&&t<=32){n=[this.parse(e[1]),t];Object.defineProperty(n,"toString",{value:function(){return this.join("/")}});return n}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")};n.IPv4.subnetMaskFromPrefixLength=function(t){var e,n,i;t=parseInt(t);if(t<0||t>32)throw new Error("ipaddr: invalid IPv4 prefix length");i=[0,0,0,0];n=0;e=Math.floor(t/8);while(n<e){i[n]=255;n++}e<4&&(i[e]=Math.pow(2,t%8)-1<<8-t%8);return new(this||r)(i)};n.IPv4.broadcastAddressFromCIDR=function(t){var e,n,i,o,a,s;try{e=this.parseCIDR(t);o=e[0].toByteArray();s=this.subnetMaskFromPrefixLength(e[1]).toByteArray();a=[];i=0;while(i<4){a.push(parseInt(o[i],10)|255^parseInt(s[i],10));i++}return new(this||r)(a)}catch(r){n=r;throw new Error("ipaddr: the address does not have IPv4 CIDR format")}};n.IPv4.networkAddressFromCIDR=function(t){var e,n,i,o,a,s;try{e=this.parseCIDR(t);o=e[0].toByteArray();s=this.subnetMaskFromPrefixLength(e[1]).toByteArray();a=[];i=0;while(i<4){a.push(parseInt(o[i],10)&parseInt(s[i],10));i++}return new(this||r)(a)}catch(r){n=r;throw new Error("ipaddr: the address does not have IPv4 CIDR format")}};n.IPv6.parseCIDR=function(r){var t,e,n;if(e=r.match(/^(.+)\/(\d+)$/)){t=parseInt(e[2]);if(t>=0&&t<=128){n=[this.parse(e[1]),t];Object.defineProperty(n,"toString",{value:function(){return this.join("/")}});return n}}throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")};n.isValid=function(r){return n.IPv6.isValid(r)||n.IPv4.isValid(r)};n.parse=function(r){if(n.IPv6.isValid(r))return n.IPv6.parse(r);if(n.IPv4.isValid(r))return n.IPv4.parse(r);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")};n.parseCIDR=function(r){var t;try{return n.IPv6.parseCIDR(r)}catch(e){t=e;try{return n.IPv4.parseCIDR(r)}catch(r){t=r;throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}};n.fromByteArray=function(r){var t;t=r.length;if(4===t)return new n.IPv4(r);if(16===t)return new n.IPv6(r);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")};n.process=function(r){var t;t=this.parse(r);return"ipv6"===t.kind()&&t.isIPv4MappedAddress()?t.toIPv4Address():t}}).call(t);var n=e.exports;export default n;

